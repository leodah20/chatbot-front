<!doctype html>
<html lang="pt-br">
<head>
    <!-- Configuração básica da página -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Gestão de Avisos - Painel Administrativo</title>

    <!-- Carregamento otimizado de fontes Google -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- CSS específico da seção de avisos -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/docentes_styles.css') }}">
</head>
<body>
    <!-- Cabeçalho principal -->
    <header>
        <div class="top">
            <!-- Logo e título da UNIP -->
            <div class="brand">
                <img src="https://api.builder.io/api/v1/image/assets/TEMP/c31fcbcb8d593740846e1ea27ca675ca1434c256?width=558" alt="UNIP Logo">
                <h1>Painel Administrativo</h1>
            </div>
            
            <!-- Informações do usuário logado -->
            <div class="user">
                <div class="meta">
                    <div class="name">{{ session.user.nome|title if session.user else 'Usuário' }}</div>
                    <div class="email">{{ session.user.email if session.user else '' }}</div>
                </div>
                <a href="{{ url_for('logout') }}" class="logout">sair</a>
            </div>
        </div>
        
        <!-- Navegação -->
        <div class="bottom">
            <!-- Link para voltar ao Dashboard -->
            <a href="{{ url_for('dashboard') }}" style="color: white; text-decoration: none; display: flex; align-items: center; gap: 12px;">
                <svg class="icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.8333 10H4.16667M10 4.16667L4.16667 10L10 15.8333" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>Voltar ao Dashboard</span>
            </a>
        </div>
    </header>

    <!-- Conteúdo principal -->
    <main class="container">
        <!-- Card principal -->
        <div class="card">
            <!-- Cabeçalho da seção -->
            <div class="section-title">
                <svg class="icon" width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M35 15H5C3.61929 15 2.5 16.1193 2.5 17.5V32.5C2.5 33.8807 3.61929 35 5 35H35C36.3807 35 37.5 33.8807 37.5 32.5V17.5C37.5 16.1193 36.3807 15 35 15Z" fill="#1583FF"/>
                    <path d="M35 5H5C3.61929 5 2.5 6.11929 2.5 7.5V12.5C2.5 13.8807 3.61929 15 5 15H35C36.3807 15 37.5 13.8807 37.5 12.5V7.5C37.5 6.11929 36.3807 5 35 5Z" fill="#1583FF"/>
                    <path d="M8.75 8.75H31.25V11.25H8.75V8.75Z" fill="white"/>
                    <path d="M8.75 20H31.25V22.5H8.75V20Z" fill="white"/>
                    <path d="M8.75 25H31.25V27.5H8.75V25Z" fill="white"/>
                    <path d="M8.75 30H31.25V32.5H8.75V30Z" fill="white"/>
                </svg>
                <div>
                    <h2>Gestão de Avisos</h2>
                    <p>Gerencie avisos e comunicados do sistema</p>
                </div>
            </div>

            <!-- Sistema de mensagens flash -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="flash-messages">
                        {% for category, message in messages %}
                            <div class="alert alert-{{ 'danger' if category == 'error' else 'success' if category == 'success' else 'info' }}">
                                {{ message }}
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <!-- Barra de ações -->
            <div class="actions-bar">
                <a href="{{ url_for('avisos_add') }}" class="btn btn-primary">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 4.16667V15.8333M4.16667 10H15.8333" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Novo Aviso
                </a>
                
                <!-- Filtros e busca -->
                <div class="filters">
                    <input type="text" placeholder="Buscar avisos..." class="search-input">
                    <select class="filter-select">
                        <option value="">Todos os avisos</option>
                        <option value="recentes">Mais recentes</option>
                        <option value="antigos">Mais antigos</option>
                    </select>
                </div>
            </div>

            <!-- Lista de avisos -->
            <div class="content">
                {% if avisos %}
                    <div class="avisos-grid">
                        {% for aviso in avisos %}
                            <div class="aviso-card">
                                <!-- Cabeçalho do aviso -->
                                <div class="aviso-header">
                                    <h3 class="aviso-titulo">{{ aviso.titulo }}</h3>
                                    <div class="aviso-meta">
                                        <span class="aviso-data">{{ aviso.data }}</span>
                                        {% if aviso.id_professor %}
                                            <span class="aviso-autor">Professor</span>
                                        {% elif aviso.id_coordenador %}
                                            <span class="aviso-autor">Coordenador</span>
                                        {% endif %}
                                    </div>
                                </div>
                                
                                <!-- Conteúdo do aviso -->
                                <div class="aviso-conteudo">
                                    <p>{{ aviso.conteudo[:150] }}{% if aviso.conteudo|length > 150 %}...{% endif %}</p>
                                </div>
                                
                                <!-- Ações do aviso -->
                                <div class="aviso-actions">
                                    <a href="{{ url_for('avisos_view', aviso_id=aviso.id_aviso) }}" class="btn btn-sm btn-outline">
                                        <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M10 12.5C11.3807 12.5 12.5 11.3807 12.5 10C12.5 8.61929 11.3807 7.5 10 7.5C8.61929 7.5 7.5 8.61929 7.5 10C7.5 11.3807 8.61929 12.5 10 12.5Z" fill="currentColor"/>
                                            <path d="M10 1.25C5.83333 1.25 2.275 3.75 1.25 7.5C2.275 11.25 5.83333 13.75 10 13.75C14.1667 13.75 17.725 11.25 18.75 7.5C17.725 3.75 14.1667 1.25 10 1.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        Visualizar
                                    </a>
                                    
                                    <a href="{{ url_for('avisos_edit', aviso_id=aviso.id_aviso) }}" class="btn btn-sm btn-outline">
                                        <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M11.25 2.5L17.5 8.75L6.25 20H2.5V16.25L11.25 2.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M14.375 5.625L16.875 8.125" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        Editar
                                    </a>
                                    
                                    <form method="POST" action="{{ url_for('avisos_delete', aviso_id=aviso.id_aviso) }}" style="display: inline;" onsubmit="return confirm('Tem certeza que deseja remover este aviso?')">
                                        <button type="submit" class="btn btn-sm btn-danger">
                                            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M2.5 5H4.16667H17.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M6.66663 5V3.33333C6.66663 2.89131 6.84222 2.46738 7.15478 2.15482C7.46734 1.84226 7.89127 1.66667 8.33329 1.66667H11.6666C12.1087 1.66667 12.5326 1.84226 12.8451 2.15482C13.1577 2.46738 13.3333 2.89131 13.3333 3.33333V5M15.8333 5V16.6667C15.8333 17.1087 15.6577 17.5326 15.3451 17.8452C15.0326 18.1577 14.6087 18.3333 14.1666 18.3333H5.83329C5.39127 18.3333 4.96734 18.1577 4.65478 17.8452C4.34222 17.5326 4.16663 17.1087 4.16663 16.6667V5H15.8333Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M8.33337 9.16667V14.1667" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M11.6666 9.16667V14.1667" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                            Remover
                                        </button>
                                    </form>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <!-- Estado vazio -->
                    <div class="empty-state">
                        <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M70 30H10C7.23858 30 5 32.2386 5 35V65C5 67.7614 7.23858 70 10 70H70C72.7614 70 75 67.7614 75 65V35C75 32.2386 72.7614 30 70 30Z" fill="#E5E7EB"/>
                            <path d="M70 10H10C7.23858 10 5 12.2386 5 15V25C5 27.7614 7.23858 30 10 30H70C72.7614 30 75 27.7614 75 25V15C75 12.2386 72.7614 10 70 10Z" fill="#E5E7EB"/>
                            <path d="M17.5 17.5H62.5V22.5H17.5V17.5Z" fill="#9CA3AF"/>
                            <path d="M17.5 40H62.5V45H17.5V40Z" fill="#9CA3AF"/>
                            <path d="M17.5 50H62.5V55H17.5V50Z" fill="#9CA3AF"/>
                            <path d="M17.5 60H62.5V65H17.5V60Z" fill="#9CA3AF"/>
                        </svg>
                        <h3>Nenhum aviso encontrado</h3>
                        <p>Comece criando seu primeiro aviso para comunicar com os usuários.</p>
                        <a href="{{ url_for('avisos_add') }}" class="btn btn-primary">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 4.16667V15.8333M4.16667 10H15.8333" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Criar Primeiro Aviso
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </main>

    <!-- JavaScript para funcionalidades interativas -->
    <script>
        // Busca em tempo real
        document.querySelector('.search-input').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const avisoCards = document.querySelectorAll('.aviso-card');
            
            avisoCards.forEach(card => {
                const titulo = card.querySelector('.aviso-titulo').textContent.toLowerCase();
                const conteudo = card.querySelector('.aviso-conteudo').textContent.toLowerCase();
                
                if (titulo.includes(searchTerm) || conteudo.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        });

        // Filtro por data
        document.querySelector('.filter-select').addEventListener('change', function(e) {
            const filter = e.target.value;
            const avisoCards = document.querySelectorAll('.aviso-card');
            
            avisoCards.forEach(card => {
                if (filter === '') {
                    card.style.display = 'block';
                } else if (filter === 'recentes') {
                    // Lógica para mostrar mais recentes primeiro
                    card.style.display = 'block';
                } else if (filter === 'antigos') {
                    // Lógica para mostrar mais antigos primeiro
                    card.style.display = 'block';
                }
            });
        });
    </script>
</body>
</html>
